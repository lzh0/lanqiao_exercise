C51 COMPILER V9.60.0.0   NIXIETUBE                                                         07/03/2020 22:40:07 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE NIXIETUBE
OBJECT MODULE PLACED IN .\Objects\nixietube.obj
COMPILER INVOKED BY: D:\keil_c51\C51\BIN\C51.EXE lib\nixietube.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\e2;.\lib) DEBUG OBJEC
                    -TEXTEND PRINT(.\Listings\nixietube.lst) TABS(2) OBJECT(.\Objects\nixietube.obj)

line level    source

   1          /*---------------------------------------
   2          æ–‡ä»¶åï¼šnixietube.c
   3          
   4          ç‰ˆæœ¬ä¿¡æ¯ï¼šv2020.7.3 21:26 release
   5          
   6          ç‰ˆæœ¬å·ï¼šv2
   7          
   8          å½“å‰ç‰ˆæœ¬åŠŸèƒ½ï¼šæ•´æ•°ã€å°æ•°å’Œè´Ÿæ•°çš„æ•°ç ç®¡8ä½æ˜¾ç¤º
   9          
  10          å½“å‰ç‰ˆæœ¬é—®é¢˜ï¼š
  11          
  12          ä¸‹ä¸€æ–°ç‰ˆæœ¬åŠŸèƒ½ï¼š
  13          
  14          -----------------------------------------*/
  15          
  16          
  17          #include <nixietube.h>
  18          #include <STC15F2K60S2.h>
  19          
  20          sbit P2_5=P2^5;
  21          sbit P2_6=P2^6;
  22          sbit P2_7=P2^7;
  23          
  24          void delay_ms(unsigned int t)   //@11.0592MHz
  25          { 
  26   1        unsigned int z;
  27   1        unsigned char i, j;
  28   1        for(z=0;z<t;z++){
  29   2          i = 15;
  30   2          j = 90;
  31   2          do
  32   2          {
  33   3            while (--j);
  34   3          } while (--i);  
  35   2        }
  36   1      }
  37          
  38          /*
  39          unsigned long e(unsigned char n){ //ç”¨äºæ±‚10çš„Næ¬¡æ–¹å‡½æ•°ï¼Œç›®å‰æœ€é«˜8æ¬¡æ–¹
  40            switch(n){
  41              case 0: return 1 ;
  42              case 1: return 10 ;
  43              case 2: return 100 ;
  44              case 3: return 1000 ;
  45              case 4: return 10000 ;
  46              case 5: return 100000 ;
  47              case 6: return 1000000 ;
  48              case 7: return 10000000 ;
  49              case 8: return 100000000 ;
  50            }
  51            return 0;
  52          }
  53          */
  54          
C51 COMPILER V9.60.0.0   NIXIETUBE                                                         07/03/2020 22:40:07 PAGE 2   

  55          void display(unsigned char inn,unsigned char bit_){ //ä½ç æ®µç æ•´åˆåç‰ˆæœ¬
  56   1        P2_5=1;//y7
  57   1        P2_6=1;
  58   1        P2_7=1;
  59   1        switch(inn){//ä½ç 
  60   2          //ä»¥ä¸‹ä¸ºä¸å¸¦å°æ•°ç‚¹
  61   2          case 0:P0=0xc0;break;
  62   2          case 1:P0=0xf9;break;
  63   2          case 2:P0=0xa4;break;
  64   2          case 3:P0=0xb0;break;
  65   2          case 4:P0=0x99;break;
  66   2          case 5:P0=0x92;break;
  67   2          case 6:P0=0x82;break;
  68   2          case 7:P0=0xf8;break;
  69   2          case 8:P0=0x80;break;
  70   2          case 9:P0=0x90;break;
  71   2          
  72   2          //å°æ•°ç‚¹æ¨¡å¼
  73   2          //å¦‚æœå«Œé€Ÿåº¦æ…¢å¯ä»¥æŠŠå¸¦å°æ•°ç‚¹æ˜¾ç¤ºå•ç‹¬æ‹¿å‡ºæ¥å†™ä¸ªå‡½æ•°ã€‚æ­¤å¤„å¾…ä¼˜åŒ–ã€‚
  74   2          case 10:P0=0x40;break;
  75   2          case 11:P0=0x79;break;
  76   2          case 12:P0=0x24;break;
  77   2          case 13:P0=0x30;break;
  78   2          case 14:P0=0x19;break;
  79   2          case 15:P0=0x12;break;
  80   2          case 16:P0=0x02;break;
  81   2          case 17:P0=0x78;break;
  82   2          case 18:P0=0x00;break;
  83   2          case 19:P0=0x10;break;
  84   2          
  85   2          case 20:P0=0xbf;break;  //è´Ÿæ•°ç¬¦å·æ˜¾ç¤º
  86   2          
  87   2          default:P0=0xff;break;  //é»˜è®¤å…¨ç­
  88   2          
  89   2        }
  90   1        P2_5=0; //y6
  91   1        P2_6=1;
  92   1        P2_7=1;
  93   1        switch(bit_){//æ®µç 
  94   2          case 8:P0=0x01;break;
  95   2          case 7:P0=0x02;break;
  96   2          case 6:P0=0x04;break;
  97   2          case 5:P0=0x08;break;
  98   2          case 4:P0=0x10;break;
  99   2          case 3:P0=0x20;break;
 100   2          case 2:P0=0x40;break;
 101   2          case 1:P0=0x80;break;
 102   2          default:P0=0;break;
 103   2        }
 104   1        delay_ms(1);
 105   1      }
 106          
 107          void all_digital_tube_display(double number){
 108   1        //1.ç¡®å®šæ•´æ•°ä½æ•°ï¼Œå¹¶å°†è‡³ä»æœ€å·¦ä¾§æ•°ç ç®¡8å¼€å§‹æ˜¾ç¤ºï¼Œæœ€åä¸€ä½å¯ç”¨å°æ•°ç‚¹ã€‚
 109   1        long   int_part=(long)number;
 110   1        double dec_part=number-int_part;
 111   1        
 112   1        char i=0,bits=8;  //è·å–æ•´æ•°ä¸Šæ¯ä½çš„æ•°å­—åŠæ•´æ•°ä½æ•°
 113   1        char int_part_array[8]={0}; //ç”¨äºæ¯ä½æš‚å­˜//æ·»åŠ å…¨å…ƒç´ ç½®é›¶={0}è§£å†³äº†æ˜¾ç¤ºå°äº1çš„å°æ•
             -°æ—¶å‡ºç°çš„ä¸ªä½0æ˜¾ç¤ºä¸ºé™¤æ•°é”™è¯¯çš„é—®é¢˜
 114   1      
 115   1        
C51 COMPILER V9.60.0.0   NIXIETUBE                                                         07/03/2020 22:40:07 PAGE 3   

 116   1        
 117   1        if (number<0){  //è´Ÿæ•°å¤„ç†
 118   2          display(20,bits--);
 119   2          number = -(number);
 120   2          int_part = -(int_part);
 121   2          dec_part = -(dec_part);
 122   2          }
 123   1        
 124   1        
 125   1        
 126   1        
 127   1        //å°æ•°åŠæ•´æ•°éƒ¨åˆ†æ˜¾ç¤º
 128   1        while(int_part>0){  
 129   2          int_part_array[i++]=(int_part%10);  //ä»ä½ä½åˆ°é«˜ä½è·å–
 130   2          int_part=int_part/10;
 131   2        } //æ³¨æ„ç»“æŸæ—¶iä¸ºå®é™…æ•´æ•°éƒ¨åˆ†é•¿åº¦+1ï¼Œå› ä¸ºä»0å¼€å§‹è®¡æ•°ã€‚
 132   1        
 133   1        
 134   1        //æ‰“å°æ•´æ•°éƒ¨åˆ†ï¼Œæ³¨æ„æœ€åä¸€ä½åŠ ä¸Šå°æ•°ç‚¹ã€‚
 135   1        while(i>1){ //åªæ‰“å°åˆ°å°æ•°ç‚¹å‰ä¸€ä½ï¼Œæœ€åä¸€ä½å¸¦å°æ•°ç‚¹ç‰¹æ®Šå¤„ç†
 136   2          display(int_part_array[--i],bits--);  //åœ¨ç¬¬8ä½ä¸Šæ‰“å°æ•´æ•°æœ€é«˜ä½
 137   2          
 138   2        }
 139   1        
 140   1        if (i == 0) {i++;}//æ•°å­—0çš„æ˜¾ç¤ºè¡¥ä¸ï¼Œé˜²æ­¢æ˜¾ç¤º0æ—¶è®¿é—®è¶…å‡ºæ•°ç»„ä¸‹ç•Œ
 141   1        
 142   1        display((int_part_array[--i])+10,bits--); //æ‰“å°æœ€åä¸€ä½æ•´æ•°ï¼Œå¸¦å°æ•°ç‚¹ï¼Œå¹¶è®©bitsæ‰€æŒ‡å‘
             -ä¸‹ä¸€ä¸ªç©ºä½
 143   1        
 144   1        //2.å‰©ä¸‹8-æ•´æ•°ä½æ•°ï¼Œçš„åœ°æ–¹å…¨ç”¨æ¥æ‰“å°å°æ•°ç‚¹åæ•°å­—
 145   1        while(bits>0){
 146   2          display((char)(dec_part=dec_part*10),bits--);
 147   2          dec_part=dec_part-(char)dec_part;
 148   2          
 149   2        }
 150   1      }
 151            
 152          
 153          
 154          //æ—§ç‰ˆæ˜¾ç¤ºæ–¹æ³•ï¼ˆä¸å«å°æ•°ï¼‰
 155          /*
 156          void all_digital_tube_display_v0(unsigned long number){
 157            display( (number/10000000),8);
 158            display(((number%10000000)/1000000),7);
 159            display(((number%1000000)/100000),6);
 160            display(((number%100000)/10000),5);
 161            display(((number%10000)/1000),4);
 162            display(((number%1000)/100),3);
 163            display(((number%100)/10),2);
 164            display( (number%10),1);
 165          }*/
 166          
 167          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    717    ----
   CONSTANT SIZE    =      8    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      22
   IDATA SIZE       =   ----    ----
C51 COMPILER V9.60.0.0   NIXIETUBE                                                         07/03/2020 22:40:07 PAGE 4   

   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
